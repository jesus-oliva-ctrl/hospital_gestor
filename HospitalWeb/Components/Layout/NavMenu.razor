@using HospitalData.Services
@implements IDisposable
@inject UserSessionService SessionService

<MudNavMenu>
    <MudNavLink Href="" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">Inicio</MudNavLink>

    @if (SessionService.CurrentUser != null)
    {
        var rol = SessionService.CurrentUser.RoleName;

        @if (rol == "Administrativo")
        {
            <MudNavGroup Title="Administración" Icon="@Icons.Material.Filled.AdminPanelSettings" Expanded="true">
                <MudNavLink Href="gestion-doctores" Icon="@Icons.Material.Filled.MedicalServices">Doctores</MudNavLink>
                <MudNavLink Href="gestion-pacientes" Icon="@Icons.Material.Filled.People">Pacientes</MudNavLink>
                <MudNavLink Href="gestion-laboratoristas" Icon="@Icons.Material.Filled.Biotech">Laboratoristas</MudNavLink>
                <MudNavLink Href="gestion-inventario" Icon="@Icons.Material.Filled.Inventory">Inventario</MudNavLink>
                <MudNavLink Href="calendario-citas" Icon="@Icons.Material.Filled.CalendarMonth">Calendario General</MudNavLink>
            </MudNavGroup>
        }

        @if (rol == "Medico")
        {
            <MudNavGroup Title="Consultorio" Icon="@Icons.Material.Filled.HealthAndSafety" Expanded="true">
                <MudNavLink Href="panel-doctor" Icon="@Icons.Material.Filled.AssignmentInd">Mi Agenda</MudNavLink>
                <MudNavLink Href="historial-consultas" Icon="@Icons.Material.Filled.History">Historial Consultas</MudNavLink>
            </MudNavGroup>
        }

        @if (rol == "Paciente")
        {
            <MudNavGroup Title="Mi Salud" Icon="@Icons.Material.Filled.Favorite" Expanded="true">
                <MudNavLink Href="mis-citas" Icon="@Icons.Material.Filled.Event">Mis Citas</MudNavLink>
                <MudNavLink Href="agendar-cita" Icon="@Icons.Material.Filled.AddCircleOutline">Agendar Cita</MudNavLink>
                <MudNavLink Href="mis-recetas" Icon="@Icons.Material.Filled.Medication">Mis Recetas</MudNavLink>
                <MudNavLink Href="mi-historial" Icon="@Icons.Material.Filled.Description">Expediente Clínico</MudNavLink>
            </MudNavGroup>
        }

        @if (rol == "Laboratorista")
        {
            <MudNavGroup Title="Laboratorio" Icon="@Icons.Material.Filled.Biotech" Expanded="true">
                <MudNavLink Href="panel-laboratorio" Icon="@Icons.Material.Filled.AssignmentTurnedIn">
                    Solicitudes Pendientes
                </MudNavLink>
                <MudNavLink Href="historial-laboratorio" Icon="@Icons.Material.Filled.ManageSearch">
                    Historial de Pruebas
                </MudNavLink>
            </MudNavGroup>
        }
    }
    else
    {
        <MudNavLink Href="login" Icon="@Icons.Material.Filled.Login">Iniciar Sesión</MudNavLink>
    }
</MudNavMenu>

@code {
    protected override void OnInitialized()
    {
        SessionService.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        SessionService.OnChange -= StateHasChanged;
    }
}